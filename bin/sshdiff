#!/bin/bash
# Print differences between local and remote file or command
#
# Usage: sshdiff [user@]host /full/path/to/file
#        sshdiff [user@]host command

usage() {
	echo "Usage: sshdiff [user@]host <file|command>

    Print differences between local and remote file or command
"
}

if [[ "$1" == -h || "$1" == --help ]]; then
	usage
	exit
fi

HOST="$1"
shift

if [[ $# == 1 && "$1" == /* ]]; then
	# diff a file
	ssh -- $HOST "cat $1" | diff -u - "$1"
else
	# diff the output of a command
	ssh -- $HOST "$*" | diff -u - <("$@")
fi

